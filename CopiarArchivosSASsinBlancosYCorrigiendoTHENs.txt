Sub contarlineas()
Dim regEx1 As New RegExp
With regEx1
    .Global = True
    .MultiLine = True
    .IgnoreCase = True
    .Pattern = "(.+);"
End With

Open "C:\Users\franro04\Documents\SAS\GeradorPuro84.txt" For Input As #1
Open "C:\Users\franro04\Documents\SAS\GeradorPuro84-2.txt" For Output As #2
a = 0: c = 0
Do While Not EOF(1)
    a = a + 1
    Line Input #1, b
    If Not regEx1.Test(b) Then
        juntos = juntos & b
    ElseIf Len(b) > 0 And juntos = "" Then
        Print #2, b
        c = c + 1
        juntos = ""
    ElseIf Len(b) > 0 Then
        juntos = juntos & b
        Print #2, juntos
        c = c + 1
        juntos = ""
    End If
Loop
Close #1
Close #2
MsgBox (a & ":" & c)


End Sub